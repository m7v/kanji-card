(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{105:function(e,t,a){e.exports=a(224)},114:function(e,t,a){},224:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(22),c=a.n(r),o=a(250),s=a(249),l=a(102),d=a(54),u=a.n(d),f=a(101),m=a.n(f);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var v=a(226),p=a(248),g=a(30),b=a(13),h=a(33),y=a(94),w=a(251),j=a(247),O=a(62),k=a.n(O),E=a(7),N=a(245),C=a(246),L=a(5),x=a(11),S=a(10),F=a(8),D=a(9),T=(a(114),a(89)),R=a.n(T),B=function(e){function t(){return Object(L.a)(this,t),Object(S.a)(this,Object(F.a)(t).apply(this,arguments))}return Object(D.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){var e=R()({FlipCard:!0,FlipCard__flipped:this.props.isFlipped});return i.a.createElement("div",{className:e},i.a.createElement("div",{className:"FlipCard__Flipper"},i.a.createElement("div",{className:"FlipCard__Front"},this.props.children[0]),i.a.createElement("div",{className:"FlipCard__Back"},this.props.children[1])))}}]),t}(i.a.PureComponent);function I(e){var t=K(),a=i.a.useState({isFlipped:!1}),n=Object(b.a)(a,2),r=n[0].isFlipped,c=n[1],o=k()(function(){return c({isFlipped:!0})},150),s=k()(function(){return c({isFlipped:!1})},150);return i.a.createElement("div",{className:t.paper},i.a.createElement(B,{isFlipped:r},i.a.createElement(N.a,{className:Object(E.a)(t.main,t.card),onClick:o},i.a.createElement("div",{className:Object(E.a)(t.tags)},e.data.tags.map(function(e,t){return i.a.createElement("div",{key:"".concat(t).concat(e)},e)})),i.a.createElement(C.a,{variant:"h1"},e.data.sign)),i.a.createElement(N.a,{className:Object(E.a)(t.other,t.card),onClick:s},i.a.createElement(C.a,{variant:"h2",gutterBottom:!0},e.data.sign),i.a.createElement("div",null,i.a.createElement(C.a,{variant:"subtitle2",gutterBottom:!0},e.data.on),i.a.createElement(C.a,{variant:"subtitle2",gutterBottom:!0},e.data.kun),i.a.createElement(C.a,{variant:"body1",gutterBottom:!0},e.data.meaning)))))}var K=Object(v.a)(function(e){return{paper:{cursor:"pointer",height:350,width:250},card:{userSelect:"none",borderRadius:10,padding:e.spacing(2),height:"100%",width:"100%",textAlign:"center",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},main:{},other:{color:e.palette.text.secondary},tags:{position:"absolute",top:"10px",right:"10px",color:"#ccc"}}}),P=a(12),_=a(63),W=a.n(_),H=(a(120),a(122),a(91)),M=a.n(H),Y=a(92),G=a.n(Y),J=a(93),A=a.n(J),z={apiKey:"AIzaSyCxWPw-_hj73EsObm7pcbU7Td2CSFtubLw",authDomain:"kanji-anki.firebaseapp.com",databaseURL:"https://kanji-anki.firebaseio.com",projectId:"kanji-anki",storageBucket:"kanji-anki.appspot.com",messagingSenderId:"15839805144",appId:"1:15839805144:web:106f949c5bcb48bd"},U=!!localStorage.getItem("\u79c1\u306e\u4fe1\u4ef0"),V=function(){var e=new Date;return new Date("".concat(e.getMonth()+1,".").concat(e.getDate(),".").concat(e.getFullYear()," ").concat(e.getHours(),":").concat(e.getMinutes())).getTime()},X=new(function(){function e(){Object(L.a)(this,e),W.a.initializeApp(z),this.db=W.a.database()}return Object(x.a)(e,[{key:"getKanjiCards",value:function(){var e=this;return new Promise(function(t){e.db.ref("/").once("value",function(a){var n=!1,i=a.val(),r=V(),c=Object.values(i.reviewList||{}),o=Object.keys(i.reviewList||{}),s=Object.values(i.knowList||{}),l=Object.keys(i.knowList||{}),d=i.config.levels||[],u=i.config.prefererOrder||[],f=Object.values(i.items).filter(function(e){return d.includes(e.tags[0])}),m=new Date(i.activity.date).getDate(),v=new Date(r).getDate();if(i.activity.date||e.db.ref("activity/date").set(r),i.activity.date<r){var p=m===v?i.activity.date:r;e.db.ref("activity/date").set(p),i.activity.date=p;var g=m===v?i.activity.count:0;e.db.ref("activity/count").set(g),i.activity.count=g,n=0===g}var b=i.activity.count>=i.config.maxNew;if(!n&&m===v&&b&&!o.length)return t({cards:[],message:"You need to rest"});var h=[].concat(Object(P.a)(o),Object(P.a)(l)).map(function(e){return Number(e)}),y=b?[]:M()(f.filter(function(e){return!h.includes(e.id)}),function(e){return e.tags[0].match(/\d/g)[0]},"desc"),w=u.length?A()(u.map(function(e){return y.find(function(t){return t.id===e})})):y,j=[].concat(Object(P.a)(c),Object(P.a)(s)).filter(function(e){return e.date+e.day<=r}).splice(0,i.config.maxReview),O=[].concat(Object(P.a)(w.splice(0,i.config.maxNew-i.activity.count)),Object(P.a)(j));return O.length?t({cards:G()(O),message:void 0}):t({cards:[],message:"You need to rest"})})})}},{key:"lowCardStatus",value:function(e){U&&("toReview"!==e.status?"inLearning"!==e.status||this.addToNewList(e):this.addToReviewList(e))}},{key:"upCardStatus",value:function(e){var t=this;U&&("inLearning"!==e.status&&"toReview"!==e.status?(e.status||this.db.ref("/activity/count").once("value",function(e){var a=e.val();t.db.ref("activity/count").set(a+1)}),this.addToReviewList(e)):this.addToKnowList(e))}},{key:"addToKnowList",value:function(e){if(U)if("toReview"!==e.status&&e.day<=144e5)this.addToReviewList(e);else{var t=e.day+2*e.day>=2592e6?e.day+2592e6:e.day+2*e.day,a="inLearning"===e.status?function(){var e=new Date;return new Date("".concat(e.getMonth()+1,".").concat(e.getDate(),".").concat(e.getFullYear())).getTime()}():e.date;this.db.ref("knowList/".concat(e.id)).set(Object(g.a)({},e,{date:a,day:t,status:"toReview"})),this.db.ref("reviewList/".concat(e.id)).set(null)}}},{key:"addToReviewList",value:function(e){if(U){var t=e.day?e.day>=144e5?864e5:e.day+2*e.day:9e5,a=e.date?e.date:V();this.db.ref("knowList/".concat(e.id)).set(null),this.db.ref("reviewList/".concat(e.id)).set(Object(g.a)({},e,{date:a,day:t,status:"inLearning"}))}}},{key:"addToNewList",value:function(e){U&&(this.db.ref("knowList/".concat(e.id)).set(null),this.db.ref("reviewList/".concat(e.id)).set(Object(g.a)({},e,{date:V(),day:9e5,status:"inLearning"})))}}]),e}()),Z=function(e){return{x:0,y:-4*e,scale:1,rot:20*Math.random()-10,delay:50*e}},$=function(e){return{x:0,rot:0,scale:1.5,y:-1e3}},q=function(e,t){return"perspective(1000px) rotateX(5deg) rotateY(".concat(e/10,"deg) rotateZ(").concat(e,"deg) scale(").concat(t,")")},Q=new Set,ee=new Set;function te(){var e=ae(),t=i.a.useState({circle:1}),a=Object(b.a)(t,2),n=a[0].circle,r=a[1],c=i.a.useState([]),o=Object(b.a)(c,2),s=o[0],l=o[1],d=i.a.useState(void 0),u=Object(b.a)(d,2),f=u[0],m=u[1],v=Object(h.c)(s.length,function(e){return Object(g.a)({},Z(e),{from:$(e)})}),p=Object(b.a)(v,2),O=p[0],k=p[1];i.a.useEffect(function(){X.getKanjiCards().then(function(e){var t=e.cards,a=e.message;l(t),m(a)})},[]);var E=Object(y.a)(function(e){var t=Object(b.a)(e.args,1)[0],a=e.down,n=Object(b.a)(e.delta,1)[0],i=Object(b.a)(e.direction,1)[0],r=e.velocity,c=i<0?-1:1;!a&&r>.2&&(1===c&&(console.log("I know this card"),Q.add(t),X.upCardStatus(s[t])),-1===c&&(console.log("Need to repeat"),ee.add(t),X.lowCardStatus(s[t]))),k(function(e){if(t===e){var i=Q.has(t)||ee.has(t);return{x:i?(100+window.innerWidth)*c:a?n:0,rot:n/100+(i?10*c*r:0),scale:a?1.1:1,delay:void 0,config:{friction:50,tension:a?800:i?200:500}}}})});return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:e.wrapper},!!f&&i.a.createElement(C.a,{color:"secondary",variant:"h3",gutterBottom:!0},"\u4f11\u307f\u307e\u3057\u3087\u3046"),!!s.length&&i.a.createElement("div",{className:e.container},i.a.createElement(w.a,{color:"secondary",onClick:function(){console.log("Next round!"),setTimeout(function(){r({circle:n+1});var e=[];ee.forEach(function(t){return e.push(t)}),Q.clear(),ee.clear(),k(function(t){return-1!==e.indexOf(t)?Z(t):$(t)})},600)}},"\u518d\u3073\u307e\u3059\u304b")),O.map(function(t,a){var r=t.x,c=t.y,o=t.rot,l=t.scale;return i.a.createElement(h.a.div,{className:e.container,key:s[a].id,style:{transform:Object(h.b)([r,c],function(e,t){return"translate3d(".concat(e,"px,").concat(t,"px,0) rotate(").concat(e/25,"deg)")})}},i.a.createElement(h.a.div,Object.assign({},E(a),{style:{transform:Object(h.b)([o,l],q)}}),i.a.createElement(I,{key:s[a].id+n,data:s[a]})))})),!!s.length&&i.a.createElement("div",{className:e.actions},i.a.createElement(j.a,{fullWidth:!0,color:"secondary","aria-label":"Outlined primary button group"},i.a.createElement(w.a,{onClick:function(){return console.log("left")}},"\u3044\u3044\u3048"),i.a.createElement(w.a,{onClick:function(){return console.log("right")}},"\u306f\u3044"))))}var ae=Object(v.a)(function(e){return{wrapper:{backgroundColor:e.palette.primary.main,position:"fixed",overflow:"hidden",display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"},container:{userSelect:"none",backgroundColor:"transparent",position:"absolute",willChange:"transform"},actions:{position:"absolute",width:300,bottom:30}}});var ne=Object(v.a)(function(){return{root:{width:"100%",height:"100%"}}}),ie=Object(l.a)({palette:{primary:{text:u.a[500],light:u.a[700],main:m.a[50],dark:u.a[900]}},typography:{useNextVariants:!0,fontFamily:["Source Han Sans","\u6e90\u30ce\u89d2\u30b4\u30b7\u30c3\u30af","Hiragino Sans","HiraKakuProN-W3","Hiragino Kaku Gothic ProN W3","Hiragino Kaku Gothic ProN","\u30d2\u30e9\u30ae\u30ce\u89d2\u30b4 ProN W3","Noto Sans","Noto Sans CJK JP","\u30e1\u30a4\u30ea\u30aa","\u6e38\u30b4\u30b7\u30c3\u30af","\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af","MS PGothic","\uff2d\uff33 \u30b4\u30b7\u30c3\u30af","MS Gothic","sans-serif"].join(",")}});c.a.render(i.a.createElement(s.a,{theme:ie},i.a.createElement(o.a,null),i.a.createElement(function(){var e=ne();return i.a.createElement(p.a,{container:!0,justify:"center",className:e.root},i.a.createElement(te,null))},null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[105,1,2]]]);
//# sourceMappingURL=main.75aadb6d.chunk.js.map